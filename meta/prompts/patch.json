{
  "task": "Fix Labs audit gaps",
  "objective": "Update synesthetic-labs so it complies with labs_spec.md v0.1 and passes audit.",
  "gaps": [
    {
      "id": "mcp_validation_optional",
      "description": "Critic and CLI treat MCP validation as optional in relaxed mode.",
      "changes": [
        "In labs/agents/critic.py: remove relaxed skip; always require MCP validation result.",
        "CLI (labs/cli.py): exit non-zero if MCP validation fails, regardless of LABS_FAIL_FAST."
      ]
    },
    {
      "id": "logging_path",
      "description": "Logs and experiment outputs land in meta/output/* instead of meta/output/labs/.",
      "changes": [
        "Redirect all log_jsonl and experiment persistence to meta/output/labs/…",
        "Update tests/test_pipeline.py and related tests to assert the new paths.",
        "Update README.md logging docs accordingly."
      ]
    },
    {
      "id": "init_file",
      "description": "Init artefact is named init.json instead of init_labs.json.",
      "changes": [
        "Duplicate or rename meta/prompts/init.json → init_labs.json.",
        "Update docs/labs_spec.md references accordingly."
      ]
    },
    {
      "id": "determinism_tests",
      "description": "Determinism requirement untested.",
      "changes": [
        "Add tests/test_determinism.py: call AssetAssembler.generate with a fixed seed, compare two runs, assert byte-for-byte equality.",
        "Add negative case: without seed, allow variance but still schema-valid."
      ]
    },
    {
      "id": "scope_drift",
      "description": "Modulation and rule bundle generators included though spec defers them.",
      "changes": [
        "Either move labs/generator/modulation.py and rule_bundle.py to labs/experimental/ and update README.md, OR",
        "Document in docs/labs_spec.md that these are present early (mark Divergent)."
      ]
    }
  ],
  "constraints": {
    "style": "atomic diffs, grounded in file paths",
    "rules": [
      "No new dependencies",
      "Tests must pass",
      "Docs must be updated with any path/name changes"
    ]
  },
  "exit_criteria": [
    "MCP validation is mandatory in critic and CLI flows",
    "All logs and experiments written under meta/output/labs/",
    "init_labs.json exists and matches baseline",
    "Determinism test added and passing",
    "Scope drift either fixed by moving files or documented as Divergent",
    "README and docs aligned with final state"
  ]
}
